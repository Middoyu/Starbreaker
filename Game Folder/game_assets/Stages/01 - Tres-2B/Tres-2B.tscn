[gd_scene load_steps=6 format=3 uid="uid://k0rog1tlg78y"]

[ext_resource type="PackedScene" uid="uid://cr5lkcdqqb78g" path="res://Game Folder/game_components/camera_component/Camera/camera_base.tscn" id="1_3cjne"]
[ext_resource type="AudioStream" uid="uid://bdu0sxw8iwlpk" path="res://Game Folder/game_assets/Stages/01 - Tres-2B/Music/Trestuby.wav" id="1_4se7a"]
[ext_resource type="PackedScene" uid="uid://dju5f2wa2fucv" path="res://Game Folder/game_assets/Player/Main/Player.tscn" id="2_8fgom"]
[ext_resource type="PackedScene" uid="uid://tmv7qtq62kb6" path="res://Game Folder/game_assets/Stages/01 - Tres-2B/Obstacles/Gas Comets/Base/Gas Comets.tscn" id="4_661ew"]

[sub_resource type="GDScript" id="GDScript_sy80a"]
script/source = "extends StageBase

# Indicates whether enemies are currently spawning
var is_spawning = true

# Handles the spawning of enemies based on the provided pattern
func spawn_enemies_pattern(pattern: int) -> void:
	# Set is_spawning to false to prevent immediate respawning
	is_spawning = false
	
	match pattern:
		0:
			# Spawn enemies at a specific position with a given scene
			spawn_enemies(\"res://Game Folder/game_assets/Enemies/Tres-2B/Skele-Shot/enemy.tscn\", Vector2(174, 78))
	
	# Wait for 0.15 seconds before allowing spawning again
	await get_tree().create_timer(0.15, true, true, false).timeout
	
	# Re-enable spawning
	is_spawning = true

# Called every physics frame
func _physics_process(delta: float) -> void:
	sync_music()

# Syncs music timing with enemy spawning
func sync_music() -> void:
	super()
	
	if is_spawning:
		match audio_time:
			2.6:
				spawn_enemies_pattern(0)
			5.2:
				spawn_enemies_pattern(0)
	else:
		# No action needed when not spawning
		pass
"

[node name="Tres-2b" type="Node2D"]
script = SubResource("GDScript_sy80a")
default_music_WAV = ExtResource("1_4se7a")
player_starting_position = Vector2(320, 288)

[node name="Player" parent="." instance=ExtResource("2_8fgom")]

[node name="Camera" parent="." instance=ExtResource("1_3cjne")]
position = Vector2(320, 181)
limit_left = -25
limit_top = -45
limit_right = 660
limit_bottom = 380
position_smoothing_speed = 109.5
initial_zoom_value = 1.0

[node name="Gas Comet" parent="." instance=ExtResource("4_661ew")]
